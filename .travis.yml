language: ruby
rvm:
- 2.3.3
services:
- postgresql
env:
  global:
  - secure: nuHM+ImUpYTgppN2aIcHmx1K06vWZaEpnJesWzoS3kBBnuwm5c00VctuKhTJ/pXJns8KHMIBHm33jlye6qZbFGTlAalamKBZoDiXjPPGjKygYiPFoHrbneUpxpqmScHcxM8WW1QcQqDMruh2s/Yc+iEXh0CXQoHDVK7s+cq7sh+fS6SBOV6Ls6RAypf2XSBrUrcY1iqy+42Zyi58CymtxouZyH4awT5R2/isS10mEprVNmTJ8aVaedAFidJgdiJkn/CLezIfjzYpFSuiNepp6ceqzyo1FbSFHnHKRLkZOzk/ms6mQ1Yf9SHik+oU4MZACL+mxeG7vOAdbd2kNdK4zxe9Z8YW1kzGuBksx1xkbkjk6uxEC4TIJaaailMDHpI5nP8uxNv6kJw2sTmSbSNm8iQMq0O+VXEgM767+uKwZQo59AYq3NyL3p42hzOOaJpTj4M4CvHORHzTzEVKI1GHas53ylL3A56YA7mzRPziQ/MEA7DMV82IAFfaUnRChsekqpxw0TueEVD2IsSyv5Rx/093N+yGpiKA/v3Gi/FRTIH0LkPq7qd2NQFSbKsrFDyVDRRik3/NDGUmv3uE5JTyRV8HQ6R7gdOqSXPOpjJVAWRzPkQThTId+wlM6Nos/wbZ945c1l8bg8MQXqqauky1D+atMLYdFcd83y5WMi1nCi4=
bundler_args: "--without development --deployment"
cache: bundler
before_script:
- cp config/database.travis.yml config/database.yml
- bundle exec rake db:create
- bundle exec rake db:migrate
script:
- bundle exec rake test
after_success:
- curl -X POST -H 'Authorization:Bearer '$LINE_API_KEY -F "message=Success" 'https://notify-api.line.me/api/notify'
after_failure:
- curl -X POST -H 'Authorization:Bearer '$LINE_API_KEY -F "message=Failure" 'https://notify-api.line.me/api/notify'
